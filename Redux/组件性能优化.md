影响网页性能最大的因素是浏览器的重绘`reflow`和重排版`repaint`。React官方提供了一个便捷的方式来解决这个问题`PureRender`

我们通过拆分组件为子组件，进而对组件进行更细粒度的控制。这就是函数式编程的魅力之一，保持纯净状态，可以让方法或者组件更加专注，体积更小，更独立，更有复用性和测试性

### PureRender的本质
官方提供了`react-addons-pure-render-mixin`的插件，其原理为重新实现`shouldComponentUpdate`的方法，当前的`state`和`props`与之前做浅比较，如果返回`fales`，就不会调用`render`方法

```js
shouldComponentUpdate(nextProps, nextState) {
    return isDeepEqual(this.props, nextProps)
            && isDeepEqual(this.state, nextState);   
}
```

然而`PureRender`只对值进行了浅比较

### 运用PureRender
利用`createClass`构建组件时，可以使用官方插件`react-addons-pure-render-mixin`

```jsx
import PureRenderMixin from 'react-addons-pure-render-mixin';
class App extends Component {
    constructor(props) {
        super(props);
        this.shouldComponentUpdate = PureRenderMixin.shouldComponentUpdate.bind(this);
    }
    return <div className={this.props.className}>foo</div>
}
```

### 优化PureRender

* 直接将props设置为对象或者数组

我们知道，每次调用React组件其实都会重新创建组件。就算传入的数组或对象的值没有改变，他们引用的地址也会改变

```jsx
<Account style={{color: 'red'}} />
```

这样设置的props每次渲染都会创建新对象。这样的操作，我们只需要提前将其赋值为常量，不直接使用字面量即可

```jsx
const defaultStyle = {};
<Account style={this.props.style || defaultStyle} />
```

* 设置props方法并通过事件绑定在元素上面

```js
// 事件绑定写入到构造函数中
constructor(props) {
    super(props);
    this.handleChange = this.handleChange.bind(this);
}
```

* 设置子组件

```jsx
const NameItem = () => <Item><span>Arthur</span></Item>;
// 上面的组件翻译过来其实是
const NameItem = () => 
    <Item 
        children={React.createElement('span', {}, 'Arthur')}
     />
```

显然上面Item组件不管什么情况下都会直接渲染，那么如何避免这种情况

```jsx
import React, {Component} from 'react';
import PureRenderMixin from 'react-addons-pure-render-mixin';

class NameItem extends Component {
    constructor(props) {
        super(props);
        this.shouldComponentUpdata = PureRenderMixin.shouldComponentUpdate.bind(this);
    }
    render() {
        return (
            <Item><spanArthur</span>></Item>
        )
    }
}
```

### Immutable
`Immutable Data`就是一旦被创建，就不能更改的数据，对`Immutable Data`对象进行修改添加或者删除操作，都会返回一个`Immutable`对象，实现的原理就是持久化数据结构。

* Map       键值对的集合，对应于Object，ES6也有专门的Map对象
* List      有序可重复对象，对应于Array
* ArrayList 无序不可重复列表

### React建议将this.state当做不可变的

### react-addons-pref
官方提供的性能检测插件




































